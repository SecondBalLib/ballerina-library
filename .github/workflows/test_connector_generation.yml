name: Test Connector Generation

on:
  workflow_dispatch:
    inputs:
      spec-choice:
        description: "Choose which OpenAPI spec to test"
        required: true
        type: choice
        options:
          - stripe
          - petstore
        default: "stripe"

jobs:
  # Test with Stripe API
  test-stripe:
    if: inputs.spec-choice == 'stripe'
    uses: ./.github/workflows/auto_generate_connector_template.yml
    with:
      openapi-url: "https://raw.githubusercontent.com/api-specs-test/api-specs/main/openapi/stripe/stripe/2026-01-28.clover/openapi.yaml"
      ballerina-version: "2201.13.0"
      quiet-mode: true
    secrets: inherit

  # Test with Petstore API (backup reliable test spec)
  test-petstore:
    if: inputs.spec-choice == 'petstore'
    uses: ./.github/workflows/auto_generate_connector_template.yml
    with:
      openapi-url: "https://petstore3.swagger.io/api/v3/openapi.json"
      ballerina-version: "2201.13.0"
      quiet-mode: true
    secrets: inherit
